<html>
<head>
<link rel="stylesheet" href="K16.css">
</head>
<body>

<h2 id="ControlPanel">Control Panel</h2>
<div class="body">
The control panel is used to control the K16 CPU.
<img class="sketch" src="FrontPanelHelp.png" alt="Front panel help">
<p>The address LEDs always display the current value of the program counter.</p>
<p>The data LEDs displayed various values depending on which CPU function is active at the moment.</p>
<p>The sixteen data switches below the LEDs provided input to the CPU for various functions</p>
<p>The status LED is red when the CPU is stopped or halted and green when the CPU is running.</p>
<p>The control switches are used to control the CPU:</p>
<dl>
<dt>DEPOSIT/EXAMINE</dt>
<dd>Pressing DEPOSIT writes the value contained in the data switches to a register.<br>
Pressing EXAMINE fetches the value in a register, and displays its value in the data LEDs.<br>
The register selection knob is used to select the register.</dd>
<dt>RESET/STOP</dt>
<dd>Pressing STOP causes the CPU to halt after completing the current instruction.<br>
Pressing RESET causes the CPU to halt immediately, and clear all CPU internal registers.</dd>
<dt>START/CONTINUE</dt>
<dd>Pressing CONTINUE causes the CPU to resume executing at the instruction currently pointed at by the program counter.<br> 
Pressing START transfers the value currently set in data switches to the program counter and then starts execution of the program from there.</dd>
<dt>DEPOSIT/DEPOSIT NEXT</dt>
<dd>Pressing DEPOSIT writes the value contained in the data switches to the memory location pointed at by the program counter.<br>
Pressing DEPOSIT NEXT first increments the program counter and then deposits to the pointed-to memory location.</dd>
<dt>EXAMINE/EXAMINE NEXT<dt>
<dd>Pressing EXAMINE transfers the value set in data switches to the program counter, fetches the value in the corresponding memory location, and displays its value in the data LEDs.<br>
Pressing EXAMINE NEXT increments the program counter and then performed an examine operation on that memory location, allowing the user to step through a series of memory locations.</dd>
<dt>INST STEP</dt>
<dd>The INST STEP switch causes the CPU to execute one instruction, at the current program counter location, and then halts.<br> 
The program counter is incremented as part of the instruction execution.<br> 
This allows the user to single-step through a program.</dd>
</dl>
</div>
<h2 id="InstructionSet">Instruction Set</h2>
<div class="body">
The table below shows the K16 instruction set.
The table contains for each instruction the name, the description, the changed flags, and the encoding.
<table style="margin-top:5mm; margin-bottom:5mm">
  <thead>
    <tr>
      <th class="instruction">Instruction</th>
      <th class="description">Description</th>
      <th class="flags">Flags</th>
      <th class="redBit">15</th>
      <th class="redBit">14</th>
      <th class="redBit">13</th>
      <th class="redBit">12</th>
      <th class="yellowBit">11</th>
      <th class="yellowBit">10</th>
      <th class="yellowBit">9</th>
      <th class="yellowBit">8</th>
      <th class="redBit">7</th>
      <th class="redBit">6</th>
      <th class="redBit">5</th>
      <th class="redBit">4</th>
      <th class="yellowBit">3</th>
      <th class="yellowBit">2</th>
      <th class="yellowBit">1</th>
      <th class="yellowBit">0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="instruction">ADC</td>
      <td>Reg<sub>Dest</sub> = Reg<sub>Src1</sub> + Reg<sub>Src2</sub> + carry</td>
      <td>N,Z,C,O</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src1<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src2<sub></td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">1</td>
   </tr>
    <tr>
      <td class="instruction">ADD</td>
      <td>Reg<sub>Dest</sub> = Reg<sub>Src1</sub> + Reg<sub>Src2</sub></td>
      <td>N,Z,C,O</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src1<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src2<sub></td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">AND</td>
      <td>Reg<sub>Dest</sub> = Reg<sub>Src1</sub> and Reg<sub>Src2</sub></td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src1<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src2<sub></td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">1</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">ASHL</td>
      <td>Reg<sub>Dest</sub> = arithmetic shift left (Reg<sub>Src</sub>)</td>
      <td>N,Z,C</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src<sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">ASHR</td>
      <td>Reg<sub>Dest</sub> = arithmetic shift right (Reg<sub>Src</sub>)</td>
      <td>N,Z,C</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src<sub></td>
      <td >*</td>
      <td >*</td>
      <td >*</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">1</td>
	   <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">BCC</td>
      <td>Branch to Reg<sub>Base</sub> + Offset7 if carry flag is clear</td>
      <td></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Base<sub></td>
      <td style="text-align:center" colspan="7">Offset7</td>
   </tr>
   <tr>
      <td class="instruction">BCS</td>
      <td>Branch to Reg<sub>Base</sub> + Offset7 if carry flag is set</td>
      <td></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Base<sub></td>
      <td style="text-align:center" colspan="7">Offset7</td>
   </tr>
   <tr>
      <td class="instruction">BNC</td>
      <td>Branch to Reg<sub>Base</sub> + Offset7 if negative flag is clear</td>
      <td></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Base<sub></td>
      <td style="text-align:center" colspan="7">Offset7</td>
   </tr>
   <tr>
      <td class="instruction">BNS</td>
      <td>Branch to Reg<sub>Base</sub> + Offset7 if negative flag is set</td>
      <td></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Base<sub></td>
      <td style="text-align:center" colspan="7">Offset7</td>
   </tr>
   <tr>
      <td class="instruction">BOC</td>
      <td>Branch to Reg<sub>Base</sub> + Offset7 if overflow flag is clear</td>
      <td></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Base<sub></td>
      <td style="text-align:center" colspan="7">Offset7</td>
   </tr>
   <tr>
      <td class="instruction">BOS</td>
      <td>Branch to Reg<sub>Base</sub> + Offset7 if overflow flag is set</td>
      <td></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Base<sub></td>
      <td style="text-align:center" colspan="7">Offset7</td>
   </tr>
   <tr>
      <td class="instruction">BZC</td>
      <td>Branch to Reg<sub>Base</sub> + Offset7 if zero flag is clear</td>
      <td></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Base<sub></td>
      <td style="text-align:center" colspan="7">Offset7</td>
   </tr>
   <tr>
      <td class="instruction">BZS</td>
      <td>Branch to Reg<sub>Base</sub> + Offset7 if zero flag is set</td>
      <td></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Base<sub></td>
      <td style="text-align:center" colspan="7">Offset7</td>
   </tr>
   <tr>
      <td class="instruction">CLC</td>
      <td>Clear carry flag</td>
      <td>C</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">CLI</td>
      <td>Clear interrupt enable flag</td>
      <td>I</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">CMP</td>
      <td>Reg<sub>Src1</sub> - Reg<sub>Src2</sub></td>
      <td>N,Z,C,O</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center" colspan="3">Reg<sub>Src1</sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src2</sub></td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">DEC</td>
      <td>Reg<sub>Dest</sub> = Reg<sub>Src</sub> - 1</td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src</sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">HLT</td>
      <td>Halt the CPU</td>
      <td></td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">INC</td>
      <td>Reg<sub>Dest</sub> = Reg<sub>Src</sub> + 1</td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src</sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">JMP</td>
      <td>Jump to Reg<sub>Base</sub> + Offset10</td>
      <td></td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>base</sub></td>
      <td style="text-align:center" colspan="10">Offset10</td>
   </tr>
   <tr>
      <td class="instruction">JSR</td>
      <td>Jump to subroutine at Reg<sub>Base</sub> + Offset10</td>
      <td></td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>base</sub></td>
      <td style="text-align:center" colspan="10">Offset10</td>
   </tr>
   <tr>
      <td class="instruction">LD</td>
      <td>Reg<sub>Dest</sub> = Reg<sub>Src</sub></td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src</sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">LD [mem]</td>
      <td>Load Reg<sub>Dest</sub> from memory at Reg<sub>Base</sub> + Offset7</sub></td>
      <td>N,Z</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Base</sub></td>
      <td style="text-align:center" colspan="7">Offset7</td>
   </tr>
   <tr>
      <td class="instruction">LDH</td>
      <td>Reg<sub>Dest</sub>.high = Reg<sub>Src</sub>.high</td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src</sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">LDH imm8</td>
      <td>Reg<sub>Dest</sub>.high = Immediate8</td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="8">Immediate8</td>
   </tr>
   <tr>
      <td class="instruction">LDHZ imm8</td>
      <td>Reg<sub>Dest</sub>.low =0, Reg<sub>Dest</sub>.high = Immediate8</td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="8">Immediate8</td>
   </tr>
   <tr>
      <td class="instruction">LDL</td>
      <td>Reg<sub>Dest</sub>.low = Reg<sub>Src</sub>.low</td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src</sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">LDL imm8</td>
      <td>Reg<sub>Dest</sub>.low = Immediate8</td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="8">Immediate8</td>
   </tr>
   <tr>
      <td class="instruction">LDLZ imm8</td>
      <td>Reg<sub>Dest</sub>.low = imm8, Reg<sub>Dest</sub>.high = 0</td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="8">Immediate8</td>
   </tr>
   <tr>
      <td class="instruction">NOT</td>
      <td>Reg<sub>Dest</sub> = not Reg<sub>Src</sub></td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src</sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">OR</td>
      <td>Reg<sub>Dest</sub> = Reg<sub>Src1</sub> or Reg<sub>Src2</sub></td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src1</sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src2</sub></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">POP</td>
      <td>Pop Reg<sub>Dst</sub> from stack</td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">PSH</td>
      <td>Push Reg<sub>Src</sub> to stack</td>
      <td></td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest</sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">RET</td>
      <td>Return from subroutine</td>
      <td>N,Z???</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">ROL</td>
      <td>Reg<sub>Dest</sub> = rotate left (Reg<sub>Src</sub>)</td>
      <td>N,Z,C</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src<sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">1</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">ROR</td>
      <td>Reg<sub>Dest</sub> = rotate right (Reg<sub>Src</sub>)</td>
      <td>N,Z,C</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src<sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">1</td>
	   <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">RTI</td>
      <td>Return from interrupt</td>
      <td>N,Z???</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
   </tr>
   <tr>
      <td class="instruction">SBC</td>
      <td>Reg<sub>Dest</sub> = Reg<sub>Src1</sub> - Reg<sub>Src2</sub> - carry</td>
      <td>N,Z,C,O</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src1<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src2<sub></td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">1</td>
	   <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">SEC</td>
      <td>Set carry flag</td>
      <td>C</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">SEI</td>
      <td>Set interrupt enable flag</td>
      <td>I</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">SHL</td>
      <td>Reg<sub>Dest</sub> = logic shift left (Reg<sub>Src</sub>)</td>
      <td>N,Z,C</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src<sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">SHR</td>
      <td>Reg<sub>Dest</sub> = logic shift right (Reg<sub>Src</sub>)</td>
      <td>N,Z,C</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src<sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
   </tr>  
   <tr>
      <td class="instruction">STO [mem]</td>
      <td>Store Reg<sub>Src</sub> in memory at Reg<sub>Base</sub> + Offset7</td>
      <td></td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center">1</td>
      <td style="text-align:center" colspan="3">Reg<sub>Src<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Base<sub></td>
      <td style="text-align:center" colspan="7">Offset7</td>
   </tr>
   <tr>
      <td class="instruction">SUB</td>
      <td>Reg<sub>Dest</sub> = Reg<sub>Src1</sub> - Reg<sub>Src2</sub></td>
      <td>N,Z,C,O</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src1<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src2<sub></td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">1</td>
	   <td style="text-align:center">0</td>
   </tr>

   <tr>
      <td class="instruction">SWP</td>
      <td>Reg<sub>Dest</sub>.low = Reg<sub>Src</sub>.high, Reg<sub>Dest</sub>.hi = Reg<sub>Src</sub>.low</td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src<sub></td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
      <td style="text-align:center">*</td>
	   <td style="text-align:center">1</td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">1</td>
	   <td style="text-align:center">1</td>
   </tr>
   <tr>
      <td class="instruction">XOR</td>
      <td>Reg<sub>Dest</sub> = Reg<sub>Src1</sub> xor Reg<sub>Src2</sub></td>
      <td>N,Z</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center">0</td>
      <td style="text-align:center" colspan="3">Reg<sub>Dest<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src1<sub></td>
      <td style="text-align:center" colspan="3">Reg<sub>Src2<sub></td>
	   <td style="text-align:center">0</td>
	   <td style="text-align:center">1</td>
	   <td style="text-align:center">1</td>
	   <td style="text-align:center">0</td>
   </tr>
   </tbody>
</table>
</div>
<h2 id="AssemblerInstructionFormats">Assembler Instruction Formats</h2>

<h3>Three-register Instructions</h3> 
<div class="body">
The three-register instructions <b>ADC</b>, <b>ADD</b>, <b>AND</b>, <b>OR</b>, <b>SBC</b>, <b>SUB</b>, and <b>XOR</b> have  the following syntax:
<pre class ="syntax"><i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Dest</sub></i> <i>Reg<sub>Src1</sub></i> <i>Reg<sub>Src2</sub></i></pre>
</div>
<h3>Two-register Instructions</h3>
<div class="body">
The two-register instructions <b>ASHL</b>, <b>ASHR</b>, <b>DEC</b>, <b>INC</b>, <b>LD</b>, <b>LDH</b>, <b>LDL</b>, <b>NOT</b>, <b>ROL</b>, <b>ROR</b>, <b>SHL</b>, <b>SHR</b>, and <b>SWP</b> have the following syntax:
<pre class ="syntax"><i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Dest</sub></i> <i>Reg<sub>Src</sub></i></pre>
The two-register instruction <b>CMP</b> has the following syntax:
<pre class ="syntax"><i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Src1</sub></i> <i>Reg<sub>Src2</sub></i></pre>
</div>
<h3>One-register Instructions</h3> 
<div class="body">
The <b>POP</b> instruction has the following syntax:
<pre class ="syntax"><i>Label</i><b>:</b><sub>(opt)</sub> <b>POP</b> <i>Reg<sub>Dest</sub></i></pre> 
The <b>PSH</b> instruction has the following syntax:
<pre class ="syntax"><i>Label</i><b>:</b><sub>(opt)</sub> <b>PSH</b> <i>Reg<sub>Src</sub></i></pre> 
</div>
<h3>Immediate Instructions</h3>
<div class="body">
The immediate instructions <b>LDH</b> imm8, <b>LDHZ</b> imm8, <b>LDL</b> imm8, <b>LDLZ</b> imm8 have the following syntax:
<pre class ="syntax"><i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Dest</sub></i> <i>expression</i></pre>
The least significant 8 bits of <i>expression</i> are used as immediate operand.
</div>
<h3>Load from Memory Instruction</h3>
<div class="body">
The load from memory instruction <b>LD</b> [mem] has the following syntax:
<pre class ="syntax"><i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Dest</sub></i> <b>[</b></i>Reg<sub>Base</sub></i> <b>+</b> <i>expression</i><b>]</b>
<i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Dest</sub></i> <b>[</b></i>Reg<sub>Base</sub></i> <b>-</b> <i>expression</i><b>]</b>
<i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Dest</sub></i> <b>[</b></i>Reg<sub>Base</sub></i><b>]</b>
<i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Dest</sub></i> <i>Label</i></pre>
Examples:
<pre class="code">
.define $MyOffset 5
Start:     LD R2 [R3]             ; R2 = Mem[R3]
           LD R2 [R3 + 15]        ; R2 = Mem[R3 + 15]
           LD R5 [R3 - $MyOffset] ; R5 = Mem[R3 - 5]
           LD R2 Operator1        ; R2 = Mem[address of "Operator1"]
Operator1: .data 1200</pre>
</div>
<h3>Store in Memory Instruction</h3>
<div class="body">
The store in memory instruction <b>STO</b> [mem] has the following syntax:
<pre class ="syntax"><i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Src</sub></i> <b>[</b></i>Reg<sub>Base</sub></i> <b>+</b> <i>expression</i><b>]</b>
<i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Src</sub></i> <b>[</b></i>Reg<sub>Base</sub></i> <b>-</b> <i>expression</i><b>]</b>
<i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Src</sub></i> <b>[</b></i>Reg<sub>Base</sub></i><b>]</b>
<i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Reg<sub>Src</sub></i> <i>Label</i></pre>
</div>
<h3>Branch and Jump Instructions</h3>
<div class="body">
The branch and jump instructions <b>BCC</b>, <b>BCS</b>, <b>BNC</b>, <b>BNS</b>, <b>BOC</b>, <b>BOS</b>, <b>BZC</b>, <b>BZS</b>, <b>JMP</b>, and <b>JSR</b> have the following syntax:
<pre class ="syntax"><i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <b>[</b></i>Reg<sub>Base</sub></i> <b>+</b> <i>expression</i><b>]</b>
<i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <b>[</b></i>Reg<sub>Base</sub></i> <b>-</b> <i>expression</i><b>]</b>
<i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <b>[</b></i>Reg<sub>Base</sub></i><b>]</b>
<i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i> <i>Label</i></pre> 
</div>
<h3>No-argument Instructions</h3>
<div class="body">
The no-argument instructions <b>CLC</b>, <b>CLI</b>, <b>HLT</b>, <b>RET</b>, <b>RTI</b>, <b>SEC</b>, and <b>SEI</b> have the following syntax:
<pre class ="syntax"><i>Label</i><b>:</b><sub>(opt)</sub> <i>Instruction</i></pre>
</div>
<h2 id="Registers">Registers</h2>
<div class="body">
The K16 CPU has 8 registers:
<p>
<b>R0</b> .. <b>R5</b> are general purpose registers
</p>
<p>
<b>R6</b> or <b>SP</b> is the stack pointer
</p>
<p>
<b>R7</b> or <b>PC</b> is the program counter
</p>
</div>
<h2 id="AssemblerExpressions">Assembler Expressions</h2>
<h3>Numeric Literals</h3>
<div class="body">
Numberic literals can be expressed in decimal, hexadecimal, octal, or character format:
<ul>
<li>Decimal literals consist of digits '0' .. '9' <u>without</u> a leading zero</li>
<li>Hexadecimal literals consist of the prefix '0x' followed by hexadecimal digits '0' .. '9' , 'a' .. 'f', and 'A' ..'F'</li>
<li>Decimal literals consist of digits '0' .. '7' <u>with</u> a leading zero</li>
<li>Character literals consist of a single ASCII character within quotation marks</li>
</ul>
</div>
<h3>Numeric Constants</h3>
<div class="body">
Numeric constants are defined with the assembler directive '.define' (see below).
They consist of a '$' sign followed by letters and digits.<br>
Labels can also be used as numeric constants.<br>
The constant '$$' refers to the current address.
</div>
<h3>Operators</h3>
<div class="body">
The table below, shows, which operators can be used:
<table>
<tr><th>Precedence</th><th>Operator</th><th>Description</th><th>Associativity</th></tr>
<tr><td>1</td><td>.H</td><td>Bit 15 .. 8</td><td>Left-to-right</td></tr>
<tr><td>1</td><td>.L</td><td>Bit 7 .. 0</td><td>Left-to-right</td></tr>
<tr><td>1</td><td>.O</td><td>Offset from PC</td><td>Left-to-right</td></tr>
<tr><td>2</td><td>+</td><td>Unary plus</td><td>Right-to-left</td></tr>
<tr><td>2</td><td>-</td><td>Unary minus</td><td>Right-to-left</td></tr>
<tr><td>2</td><td>~</td><td>Bitwise not</td><td>Right-to-left</td></tr>
<tr><td>3</td><td>*</td><td>Multiplication</td><td>Left-to-right</td></tr>
<tr><td>3</td><td>/</td><td>Division</td><td>Left-to-right</td></tr>
<tr><td>3</td><td>%</td><td>Remainder</td><td>Left-to-right</td></tr>
<tr><td>4</td><td>+</td><td>Addition</td><td>Left-to-right</td></tr>
<tr><td>4</td><td>-</td><td>Remainder</td><td>Left-to-right</td></tr>
<tr><td>5</td><td>&lt;&lt;</td><td>Shift left</td><td>Left-to-right</td></tr>
<tr><td>5</td><td>&gt;&gt;</td><td>Shift right</td><td>Left-to-right</td></tr>
<tr><td>6</td><td>&amp;</td><td>Bitwise and</td><td>Left-to-right</td></tr>
<tr><td>7</td><td>^</td><td>Bitwise xor</td><td>Left-to-right</td></tr>
<tr><td>8</td><td>|</td><td>Bitwise or</td><td>Left-to-right</td></tr></table>
</div>
<h2 id="AssemblerDirectives">Assembler Directives</h2>
<div class="body">
The K16 assembler supports a few assembler directives.
</div>
<h3>.data</h3>
<div class="body">
Includes raw data in the output.
The directive is often used in conjunction with a label.
<p>Syntax:
<pre class ="syntax"><b>.data</b> <i>expression<sub>1</sub></i> [ <b>,</b> <i>expression<sub>2</sub></i> <b>,</b> ... <b>,</b> <i>expression<sub>n</sub></i>]</pre>
</p>
<p>
Examples:
<pre class="code">
Operand1:      .data 500
ScreenAddress: .data 0x8000
ShiftTable:    .data 1 << 1, 1 << 2, 1 << 3
               .data 40 * 30
</pre>
</p>
</div>
<h3>.define</h3>
<div class="body">
Defines a numeric constant.
Constant names must start with a dollar sign ("$").
<p>Syntax: 
<pre class ="syntax"><b>.define</b> <i>constant_name</i> <i>expression</i></pre>
</p>
<p>
Examples:
<pre class="code">
.define $Black     0x0000
.define $BgBlack   ($Black << 3) 
</pre>
</p>
</div>
<h3>.org</h3>
<div class="body">
Set the start address of the generated code.
<p>Syntax: 
<pre class ="syntax"><b>.org</b> <i>expression</i></pre>
</p>
<p>
Example:
<pre class="code">
.org 0x0100
LDL R4 0x50 
</pre>
</div>
<h3>.string</h3>
<div class="body">
Converts a string to machine words and includes it in the output.
If the string has an odd length then the least significant byte of the last maschine word is set to zero.
The directive is often used in conjunction with a label.
<p>Syntax: 
<pre class ="syntax"><b>.string</b> "<i>character<sub>1</sub></i>...<i>character<sub>n</sub></i>"</pre>
</p>
<p>
Example:
<pre class="code">
Greeting: .string "Hello world"
</pre>
</p>
</div>
<h2 id="Video">Video Frame Buffer</h2>
<div class="body">
<p>The video frame buffer starts at address 0x8000 (constant "$FrameBuf" in example code) and has 40 columns and 30 rows:</p>
<img class="sketch" src="VideoFrameBuffer.png" alt="Video frame buffer">
<p>Each frame buffer location can either contain a character or four pixels.</p>
<p>If the most significant bit is clear then the frame buffer contains an ASCII-7 character with a forground color and a background color:</p>
<img class="sketch" src="VideoCharacter.png" alt="Video character format">
<p>If the most significant bit is set then the frame buffer contains the color indexes of four pixels:</p>
<img class="sketch" src="VideoPixels.png" alt="Video pixel format">
<p>The table below shows the color indexes and the constant names for foreground and background colors:</p>
<img class="sketch" src="VideoColors.png" alt="Video color indexes and constants">
<p>The table below shows the character set:</p>
<img class="sketch" src="CharacterSet.png" alt="Character set">
</div>
<h2 id="Io">Input/output</h2>
<div class="body">
Most of the LEDs and switches of the control panel can be accessed from the program.
The table below shows the addresses of the LEDs, switches, and some counters:
<table>
<tr><th>Address</th><th>Constant</th><th>Read/write</th><th>Description</th></tr>
<tr><td>0xFFF8</td><td>$AddrSwtch</td><td>Read</td><td>Address switches</td></tr>
<tr><td>0xFFF9</td><td>|CtrlSwtch</td><td>Read</td><td>Control switch:<br>0 = none<br>
1 = START<br>
2 = CONTINUE<br>
3 = INST STEP<br>
4 = EXAMINE<br>
5 = EXAMINE NEXT<br>
6 = EXAMINE register<br>
7 = DEPOSIT<br>
8 = DEPOSIT NEXT<br>
9 = DEPOSIT register
</td></tr>
<tr><td>0xFFFA</td><td>$AddrLeds</td><td>Write</td><td>Address LEDs</td></tr>
<tr><td>0xFFFB</td><td>$DataLeds</td><td>Write</td><td>Data LEDs</td></tr>
<tr><td>0xFFFC</td><td>$RegSwtch</td><td>Read</td><td>Register selection knob:<br>
0 = R0<br>
1 = R1<br>
2 = R2<br>
3 = R3<br>
4 = R4<br>
5 = R5<br>
6 = SP<br>
7 = PC</td></tr>
<tr><td>0xFFFD</td><td>$IoCntrLo</td><td>Read</td><td>Low 16 bit of cycel counter</td></tr>
<tr><td>0xFFFE</td><td>$IoCntrHi</td><td>Read</td><td>High 16 bit of cycel counter</td></tr>
</table>
</div>

<h2>Instruction Set Details</h2>
<h3>ALU Instructions</h3>
<h4>ADD - Add</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = Reg<sub>Src1</sub> + Reg<sub>Src2</sub>
</pre>
Flags
<pre class="code">
 N Z C O I
 + + + + -
</pre>
Example:
<pre class="code">
 ADD R3 R2 R1
</pre>
<h4>ADC - Add with carry</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = Reg<sub>Src1</sub> + Reg<sub>Src2</sub> + Carry
</pre>
Flags
<pre class="code">
 N Z C O I
 + + + + -
</pre>
Example:
<pre class="code">
 ADC R5 R4 R1
</pre>
<h4>SUB - Subtract</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = Reg<sub>Src1</sub> - Reg<sub>Src2</sub>
</pre>
Flags
<pre class="code">
 N Z C O I
 + + + + -
</pre>
Example:
<pre class="code">
 SUB R3 R2 R1
</pre>
<h4>SBC - Subtract with carry</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = Reg<sub>Src1</sub> - Reg<sub>Src2</sub> - Carry
</pre>
Flags
<pre class="code">
 N Z C O I
 + + + + -
</pre>
Example:
<pre class="code">
 SBC R4 R3 R2
</pre>
<h4>AND - Logical AND</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = Reg<sub>Src1</sub> and Reg<sub>Src2</sub>
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example:
<pre class="code">
 AND R4 R3 R2
</pre>
<h4>OR - Logical OR</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = Reg<sub>Src1</sub> or Reg<sub>Src2</sub>
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example:
<pre class="code">
 OR R3 R2 R1
</pre>
<h4>XOR - Logical XOR</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = Reg<sub>Src1</sub> xor Reg<sub>Src2</sub>
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 XOR R3 R2 R1
</pre>
<h4>NOT - Logical NOT</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = not Reg<sub>Src</sub>
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: R3 = not R2
<pre class="code">
 NOT R3 R2
</pre>
<h3>Load from Register Instructions</h3>
<h4>LD - Load from register</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = Reg<sub>Src</sub>
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example:
<pre class="code">
 LD R3 R1
</pre>
<h4>LDL - Load low byte from register</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub>.low = Reg<sub>Src</sub>.low
 
 Reg<sub>Dest</sub>.high = 0
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: R3 = R2.low
<pre class="code">
 LDL R3 R2
</pre>
<h4>LDH - Load high byte from register</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub>.high = Reg<sub>Src</sub>.low
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 LDH R3 R2
</pre>
<h4>SWP - Load swapped bytes from register</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub>.high = Reg<sub>Src</sub>.low
 Reg<sub>Dest</sub>.low = Reg<sub>Src</sub>.high
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 SWP R3 R2
</pre>
<h3>Other Arithmetic Instructions</h3>
<h4>INC - Increment register</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = Reg<sub>Src</sub> + 1
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 INC R3 R2
</pre>
<h4>DEC - Decrement register</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = Reg<sub>Src</sub> - 1
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 DEC R3 R2
</pre>
<h4>CMP - Compare register</h4>
Operation
<pre class="code">
 Reg<sub>Src1</sub> - Reg<sub>Src2</sub>
</pre>
Flags
<pre class="code">
 N Z C O I
 + + + + -
</pre>
Example: 
<pre class="code">
 CMP R3 R2
</pre>
<table>
<th>Condition</th><th>Unsigned Compare Flags</th><th>Signed Compare Flags</th>
<tr>
<td>Reg<sub>Src1</sub> == Reg<sub>Src2</sub></td>
<td>Z == 1</td>       
<td>Z == 1</td>
</tr>
<tr>
<td>Reg<sub>Src1</sub> != Reg<sub>Src2</sub></td>
<td>Z == 0</td>
<td>Z == 0</td>
</tr>
<tr>
<td>Reg<sub>Src1</sub> &lt; Reg<sub>Src2</sub></td>
<td>C == 1</td>
<td>N != O</td>
</tr>
<tr>
<td>Reg<sub>Src1</sub> &gt;= Reg<sub>Src2</sub></td>
<td>C == 0</td>
<td>N == O</td>
</tr>
<tr>
<td>Reg<sub>Src1</sub> &lt<;= Reg<sub>Src2</sub></td>
<td>Z == 1 or C == 1</td>
<td>Z == 1 or N != O</td>
</tr>
<tr>
<td>Reg<sub>Src1</sub> &gt;  Reg<sub>Src2</sub></td>
<td>Z == 0 and C == 0</td>
<td>Z == 0 and N == O</td>
</tr>
</table>
<h3>Shift Instructions</h3>
<h4>SHR - Logic shift right</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = SHR(Reg<sub>Src</sub>)
</pre>
<img class="sketch" src="SHR.png" alt="SHR - Logic shift right">
Flags
<pre class="code">
 N Z C O I
 + + + - -
</pre>
Example: 
<pre class="code">
 SHR R2 R1
</pre>
<h4>SHL, ASHL - Logic and arithmetic shift left</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = SHL(Reg<sub>Src</sub>)
</pre>
<img class="sketch" src="SHL.png" alt="SHL - Logic shift left">
Flags
<pre class="code">
 N Z C O I
 + + + - -
</pre>
Example: 
<pre class="code">
 SHL R2 R1
</pre>
<h4>ASHR - Arithmetic shift right</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = ASHR(Reg<sub>Src</sub>)
</pre>
<img class="sketch" src="ASR.png" alt="ASR - Arithmetic shift right">
Flags
<pre class="code">
 N Z C O I
 + + + - -
</pre>
Example: 
<pre class="code">
 ASHR R2 R1
</pre>
<h4>ROR - Rotate right</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = ROR(Reg<sub>Src</sub>)
</pre>
<img class="sketch" src="ROR.png" alt="ROR - Rotate right">
Flags
<pre class="code">
 N Z C O I
 + + + - -
</pre>
Example: 
<pre class="code">
 ROR R2 R1
</pre>
<h4>ROL - Rotate left</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub> = ROL(Reg<sub>Src</sub>)
</pre>
<img class="sketch" src="ROL.png" alt="ROL - Rotate left">
Flags
<pre class="code">
 N Z C O I
 + + + - -
</pre>
Example: 
<pre class="code">
 ROL R2 R1
</pre>
<h3>Flag Manipulation Instructions</h3>
<h4>CLC - Clear carry flag</h4>
Operation
<pre class="code">
 C = 0
</pre>
Flags
<pre class="code">
 N Z C O I
 - - 0 - -
</pre>
Example: 
<pre class="code">
 CLC
</pre>
<h4>SEC - Set carry flag</h4>
Operation
<pre class="code">
 C = 1
</pre>
Flags
<pre class="code">
 N Z C O I
 - - 1 - -
</pre>
Example: 
<pre class="code">
 SEC
</pre>
<h4>CLI - Clear interrupt enable flag</h4>
Operation
<pre class="code">
 I = 0 
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - 0 -
</pre>
Example: 
<pre class="code">
 CLI
</pre>
<h4>SEI - Set interrupt enable flag</h4>
Operation
<pre class="code">
 I = 1
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - 1 -
</pre>
Example: 
<pre class="code">
 SEI
</pre>
<h3>Stack Instructions</h3>
<h4>PSH - Push to stack</h4>
Operation
<pre class="code">
 mem[SP] = Reg<sub>Src</sub>
 SP = SP - 1
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 PSH R4
</pre>
<h4> OP - Pop from stack</h4>
Operation
<pre class="code">
 SP = SP + 1
 Reg<sub>Dest</sub> = mem[SP]
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 POP R4
</pre>
<h4>RET - Return from subroutine</h4>
Operation
<pre class="code">
 SP = SP + 1
 PC = mem[SP]
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 RET
</pre>
<h4>RTI - Return from interrupt</h4>
Operation
<pre class="code">
 SP = SP + 1
 PC = mem[SP]
 I = 1
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - 1
</pre>
Example: 
<pre class="code">
 RET
</pre>
<h3>Conditional Branch Instructions</h3>
<h4>BCS - Branch if carry flag is set</h4>
Operation
<pre class="code">
 if C == 1 then
    if R_base == PC then
       PC = PC + 1 + offset
    else
       PC = R_base + offset
    endif
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 BCS PC +5
</pre>
<h4>BCC - Branch if carry flag is clear</h4>
Operation
<pre class="code">
 if C == 0 then
    if R_base == PC then
       PC = PC + 1 + offset
    else
       PC = R_base + offset
    endif
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 BCC R2 +17
</pre>
<h4>BZS - Branch if zero flag is set</h4>
Operation
<pre class="code">
 if Z == 1 then
    if R_base == PC then
       PC = PC + 1 + offset
    else
       PC = R_base + offset
    endif
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 BZS PC +5
</pre>

<h4>BZC - Branch if zero flag is clear</h4>
Operation
<pre class="code">
 if Z == 0 then
    if R_base == PC then
       PC = PC + 1 + offset
    else
       PC = R_base + offset
    endif
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 BZC R2 +17
</pre>
<h4>BNS - Branch if negative flag is set</h4>
Operation
<pre class="code">
 if N == 1 then
    if R_base == PC then
       PC = PC + 1 + offset
    else
       PC = R_base + offset
    endif
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 BNS PC +5
</pre>
<h4>BNC - Branch if negative flag is clear</h4>
Operation
<pre class="code">
 if N == 0 then
    if R_base == PC then
       PC = PC + 1 + offset
    else
       PC = R_base + offset
    endif
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 BNC R2 +17
</pre>
<h4>BOS - Branch if overflow flag is set</h4>
Operation
<pre class="code">
 if O == 1 then
    if R_base == PC then
       PC = PC + 1 + offset
    else
       PC = R_base + offset
    endif
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 BOS PC +5
</pre>
<h4>BOC - Branch if overflow flag is clear</h4>
Operation
<pre class="code">
 if O == 0 then
    if R_base == PC then
       PC = PC + 1 + offset
    else
       PC = R_base + offset
    endif
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 BOC R2 +17
</pre>
<h3>Load Immediate Value Instructions</h3>
<h4>LDL - Load low byte from immediate value</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub>.low = immediate
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 LDL R4 128
</pre>
<h4>LDH - Load high byte from immediate value</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub>.high = immediate
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 LDL R4 128
</pre>
Operation
<pre class="code">
 Reg<sub>Dest</sub>.low = immediate
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 LDH R4 16
</pre>
<h4>LDLZ - Load low byte from immediate value and clear high byte</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub>.low = immediate
 Reg<sub>Dest</sub>.high = 0
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 LDLZ R4 128
</pre>
<h4>LDHZ - Load high byte from immediate value and clear low byte</h4>
Operation
<pre class="code">
 Reg<sub>Dest</sub>.low = 0
 Reg<sub>Dest</sub>.high = immediate
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 LDHZ R4 128
</pre>
<h3>Jump Instruction</h3>
<h4>JMP - Jump</h4>
Operation
<pre class="code">
 if R_base == PC then
    PC = PC + 1 + offset
 else
    PC = R_base + offset
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 JMP R3 127
</pre>
<h3>Jump to Subroutine Instruction</h3>
<h4>JSR - Jump to subroutine</h4>
Operation
<pre class="code">
 mem[SP] = PC + 1
 SP = SP - 1
 if R_base == PC then
    PC = PC + 1 + offset
 else
    PC = R_base + offset
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 JSR R3 127
</pre>
<h3>Load from Memory Instruction</h3>
<h4>LD - Load from memory</h4>
Operation
<pre class="code">
 if R_base == PC then
    Reg<sub>Dest</sub> = mem[PC + 1 + offset]
 else
    Reg<sub>Dest</sub> = mem[R_base + offset]
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 + + - - -
</pre>
Example: 
<pre class="code">
 LD R4 [SP -2]
</pre>
<h3>Store in Memory Instruction</h3>
<h4>STO - Store in memory</h4>
Operation
<pre class="code">
 if R_base == PC then
    mem[PC + 1 + offset] = Reg<sub>Src</sub>
 else
    mem[R_base + offset] = Reg<sub>Src</sub>
 endif
</pre>
Flags
<pre class="code">
 N Z C O I
 - - - - -
</pre>
Example: 
<pre class="code">
 STO R3 [R2 +18]
</pre>

</body>
</html>



